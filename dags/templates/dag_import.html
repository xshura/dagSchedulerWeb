<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Dag Create</title>
    <!-- ================= Favicon ================== -->
    <!-- Standard -->
    <link rel="shortcut icon" href="http://placehold.it/64.png/000/fff">
    <!-- Retina iPad Touch Icon-->
    <link rel="apple-touch-icon" sizes="144x144" href="http://placehold.it/144.png/000/fff">
    <!-- Retina iPhone Touch Icon-->
    <link rel="apple-touch-icon" sizes="114x114" href="http://placehold.it/114.png/000/fff">
    <!-- Standard iPad Touch Icon-->
    <link rel="apple-touch-icon" sizes="72x72" href="http://placehold.it/72.png/000/fff">
    <!-- Standard iPhone Touch Icon-->
    <link rel="apple-touch-icon" sizes="57x57" href="http://placehold.it/57.png/000/fff">
    <!-- Styles -->
    <link href="../statics/assets/fontAwesome/css/fontawesome-all.min.css" rel="stylesheet">
    <link href="../statics/assets/css/lib/themify-icons.css" rel="stylesheet">
    <link href="../statics/assets/css/lib/mmc-chat.css" rel="stylesheet" />
    <link href="../statics/assets/css/lib/sidebar.css" rel="stylesheet">
    <link href="../statics/assets/css/lib/bootstrap.min.css" rel="stylesheet">
    <link href="../statics/assets/css/lib/nixon.css" rel="stylesheet">
    <link href="../statics/assets/lib/lobipanel/css/lobipanel.min.css" rel="stylesheet">
    <link href="../statics/assets/css/style.css" rel="stylesheet">

    <link rel="stylesheet" href="../statics/font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../statics/drawflow/dist/drawflow.min.css">
    <link rel="stylesheet" href="../statics/drawflow/dist/all.min.css">
    <link rel="stylesheet" type="text/css" href="../statics/drawflow/dist/beautiful.css" />
    <link rel="stylesheet" type="text/css" href="../statics/drawflow/dist/swap.css" />

    <script src="../statics/drawflow/dist/drawflow.min.js"></script>
    <script src="../statics/drawflow/dist/all.min.js"></script>
    <script src="../statics/drawflow/dist/sweetalert.min.js"></script>
    <script src="../statics/drawflow/dist/micromodal.min.js"></script>
</head>

<body>
    <div class="sidebar sidebar-hide-to-small sidebar-shrink sidebar-gestures">
        <div class="nano has-scrollbar">
            <div class="nano-content" tabindex="0" style="right: -12px;">
                <ul>
                    <li class="active">
                        <a href="/index"><i class="ti-home"></i> Admin Home <span class="sidebar-collapse-icon ti-angle-down"></span></a>
                    </li>
                    <li><a href="/dag_add"><i class="ti-layout-grid2-alt"></i> DAGs Import </a></li>
                    <li><a href="/dag"><i class="ti-layout-grid2-alt"></i> DAGs Manage </a></li>
                    <li><a href="/resource"><i class="ti-layout-grid2-alt"></i> Resource Manage</a></li>
<!--                    <li>-->
<!--                        <a class="sidebar-sub-toggle"><i class="ti-bar-chart-alt"></i>  Charts  <span class="sidebar-collapse-icon ti-angle-down"></span></a>-->
<!--                        <ul>-->
<!--                            <li><a href="chart-flot.html">Flot</a></li>-->
<!--                        </ul>-->
<!--                    </li>-->
                    <li><a href="/show"><i class="ti-view-list-alt"></i> DAGs Scheduler </a></li>
                    <li><a target="_blank" href="#"><i class="ti-file"></i> Documentation</a></li>
                </ul>
            </div>
        <div class="nano-pane" style="display: none;"><div class="nano-slider" style="height: 1030px; transform: translate(0px, 0px);"></div></div></div>
    </div>
    <div class="header">
        <div class="pull-left">
            <div class="logo">
                <a href="admin.html">
                    <img id="logoImg" src="../statics/logo/logo.png" data-logo_big="../statics/logo/logo.png" data-logo_small="../statics/logo/logoSmall.png" alt="Nixon">
                </a>
            </div>
            <div class="hamburger sidebar-toggle">
                <span class="ti-menu"></span>
            </div>
        </div>
        <div class="pull-right p-r-15">
            <ul>
                <li class="header-icon dib">
                    <i class="ti-bell"></i>
                    <div class="note-count">2</div>
                    <div class="drop-down">
                        <div class="dropdown-content-heading">
                            <span class="text-left">Recent Notifications</span>
                        </div>
                        <div class="dropdown-content-body">
                            <ul>
                                <li>
                                    <a href="#">
                                        <img class="pull-left m-r-10 avatar-img" src="../statics/assets/images/avatar/3.jpg" alt="">
                                        <div class="notification-content">
                                            <small class="notification-timestamp pull-right">02:34 PM</small>
                                            <div class="notification-heading">Mr. XSHURA</div>
                                            <div class="notification-text">5 members joined today </div>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        <img class="pull-left m-r-10 avatar-img" src="../statics/assets/images/avatar/3.jpg" alt="">
                                        <div class="notification-content">
                                            <small class="notification-timestamp pull-right">02:34 PM</small>
                                            <div class="notification-heading">Mariam</div>
                                            <div class="notification-text">likes a photo of you</div>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        <img class="pull-left m-r-10 avatar-img" src="../statics/assets/images/avatar/3.jpg" alt="">
                                        <div class="notification-content">
                                            <small class="notification-timestamp pull-right">02:34 PM</small>
                                            <div class="notification-heading">Tasnim</div>
                                            <div class="notification-text">Hi Teddy, Just wanted to let you ...</div>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        <img class="pull-left m-r-10 avatar-img" src="../statics/assets/images/avatar/3.jpg" alt="">
                                        <div class="notification-content">
                                            <small class="notification-timestamp pull-right">02:34 PM</small>
                                            <div class="notification-heading">XSHURA Roe</div>
                                            <div class="notification-text">Hi Teddy, Just wanted to let you ...</div>
                                        </div>
                                    </a>
                                </li>
                                <li class="text-center">
                                    <a href="#" class="more-link">See All</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </li>
                <li class="header-icon dib">
                    <i class="ti-email"></i>
                    <div class="note-count">21</div>
                    <div class="drop-down">
                        <div class="dropdown-content-heading">
                            <span class="text-left">2 New Messages</span>
                            <a href="app-email.html"><i class="ti-pencil-alt pull-right"></i></a>
                        </div>
                        <div class="dropdown-content-body">
                            <ul>
                                <li class="notification-unread">
                                    <a href="#">
                                        <img class="pull-left m-r-10 avatar-img" src="../statics/assets/images/avatar/1.jpg" alt="">
                                        <div class="notification-content">
                                            <small class="notification-timestamp pull-right">02:34 PM</small>
                                            <div class="notification-heading">XSHURA Doe</div>
                                            <div class="notification-text">Hi Teddy, Just wanted to let you ...</div>
                                        </div>
                                    </a>
                                </li>
                                <li class="notification-unread">
                                    <a href="#">
                                        <img class="pull-left m-r-10 avatar-img" src="../statics/assets/images/avatar/2.jpg" alt="">
                                        <div class="notification-content">
                                            <small class="notification-timestamp pull-right">02:34 PM</small>
                                            <div class="notification-heading">XSHURA Roe</div>
                                            <div class="notification-text">Hi Teddy, Just wanted to let you ...</div>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        <img class="pull-left m-r-10 avatar-img" src="../statics/assets/images/avatar/3.jpg" alt="">
                                        <div class="notification-content">
                                            <small class="notification-timestamp pull-right">02:34 PM</small>
                                            <div class="notification-heading">XSHURA Doe</div>
                                            <div class="notification-text">Hi Teddy, Just wanted to let you ...</div>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        <img class="pull-left m-r-10 avatar-img" src="../statics/assets/images/avatar/2.jpg" alt="">
                                        <div class="notification-content">
                                            <small class="notification-timestamp pull-right">02:34 PM</small>
                                            <div class="notification-heading">XSHURA Roe</div>
                                            <div class="notification-text">Hi Teddy, Just wanted to let you ...</div>
                                        </div>
                                    </a>
                                </li>
                                <li class="text-center">
                                    <a href="#" class="more-link">See All</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </li>
                <li class="header-icon dib chat-sidebar-icon"><i class="ti-comments"></i></li>
                <li class="header-icon dib">
                    <img class="avatar-img" src="../statics/assets/images/avatar/1.jpg" alt=""> <span class="user-avatar">XSHURA <i class="ti-angle-down f-s-10"></i></span>
                    <div class="drop-down dropdown-profile">
                        <div class="dropdown-content-heading">
                            <span class="text-left">Upgrade Now</span>
                            <p class="trial-day">30 Days Trail</p>
                        </div>
                        <div class="dropdown-content-body">
                            <ul>
                                <li><a href="#"><i class="ti-user"></i> <span>Profile</span></a></li>
                                <li><a href="#"><i class="ti-wallet"></i> <span>My Balance</span></a></li>
                                <li><a href="#"><i class="ti-write"></i> <span>My Task</span></a></li>
                                <li><a href="#"><i class="ti-calendar"></i> <span>My Calender</span></a></li>
                                <li><a href="#"><i class="ti-email"></i> <span>Inbox</span></a></li>
                                <li><a href="#"><i class="ti-settings"></i> <span>Setting</span></a></li>
                                <li><a href="#"><i class="ti-help-alt"></i> <span>Help</span></a></li>
                                <li><a href="#"><i class="ti-lock"></i> <span>Lock Screen</span></a></li>
                                <li><a href="#"><i class="ti-power-off"></i> <span>Logout</span></a></li>
                            </ul>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
    </div>
    <div class="chat-sidebar">
        <!-- BEGIN chat -->
        <div id="mmc-chat" class="color-default">
            <!-- BEGIN CHAT BOX -->
            <div class="chat-box">
                <!-- BEGIN CHAT BOXS -->
                <ul class="boxs"></ul>
                <!-- END CHAT BOXS -->
                <div class="icons-set">
                    <div class="stickers">
                        <div class="had-container">
                            <div class="row">
                                <div class="s12">
                                    <ul class="tabs" style="width: 100%;height: 60px;">
                                        <li class="tab col s3">
                                            <a href="#tab1" class="active">
                                                <img src="assets/images/1.png" alt="">
                                            </a>
                                        </li>
                                        <li class="tab col s3"><a href="#tab2">Test 2</a></li>
                                    </ul>
                                </div>
                                <div id="tab1" class="s12 tab-content">
                                    <ul>
                                        <li><img src="assets/images/1.png" alt=""></li>
                                        <li><img src="assets/images/1.png" alt=""></li>
                                        <li><img src="assets/images/1.png" alt=""></li>
                                        <li><img src="assets/images/1.png" alt=""></li>
                                        <li><img src="assets/images/1.png" alt=""></li>
                                        <li><img src="assets/images/1.png" alt=""></li>
                                        <li><img src="assets/images/1.png" alt=""></li>
                                        <li><img src="assets/images/1.png" alt=""></li>
                                        <li><img src="assets/images/1.png" alt=""></li>
                                        <li><img src="assets/images/1.png" alt=""></li>
                                        <li><img src="assets/images/1.png" alt=""></li>
                                        <li><img src="assets/images/1.png" alt=""></li>
                                        <li><img src="assets/images/1.png" alt=""></li>
                                    </ul>
                                </div>
                                <div id="tab2" class="s12 tab-content">Test 2</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- END CHAT BOX -->
            <!-- BEGIN SIDEBAR -->
            <div id="sidebar" class="right scroll">
                <div class="had-container">
                    <!-- BEGIN USERS -->
                    <div class="users">
                        <ul class="user-list">
                            <!-- BEGIN USER-->
                            <li class="user-tooltip" data-id="1" data-status="online" data-username="Rufat Askerov" data-position="left" data-filter-item="" data-filter-name="rufat askerov">
                                <!-- BEGIN USER IMAGE-->
                                <div class="user-image">
                                    <img src="../statics/assets/images/avatar/1.jpg" class="avatar" alt="Rufat Askerov">
                                </div>
                                <!-- END USER IMAGE-->
                                <!-- BEGIN USERNAME-->
                                <span class="user-name">Rufat Askerov</span>
                                <span class="user-show"></span>
                                <!-- END USERNAME-->
                            </li>
                            <!-- END USER-->
                            <!-- BEGIN USER-->
                            <li class="user-tooltip" data-id="3" data-status="online" data-username="Alice" data-position="left" data-filter-item="" data-filter-name="alice">
                                <div class="user-image">
                                    <img src="../statics/assets/images/avatar/1.jpg" class="avatar" alt="Alice">
                                </div>
                                <span class="user-name">Alice</span>
                                <span class="user-show"></span>
                            </li>
                            <!-- BEGIN USER-->
                            <li class="user-tooltip" data-id="7" data-status="offline" data-username="Michael Scofield" data-position="left" data-filter-item="" data-filter-name="michael scofield">
                                <div class="user-image">
                                    <img src="../statics/assets/images/avatar/1.jpg" class="avatar" alt="Michael Scofield">
                                </div>
                                <span class="user-name">Michael Scofield</span>
                                <span class="user-show"></span>
                            </li>
                            <!-- BEGIN USER-->
                            <li class="user-tooltip" data-id="5" data-status="online" data-username="Irina Shayk" data-position="left" data-filter-item="" data-filter-name="irina shayk">
                                <div class="user-image">
                                    <img src="../statics/assets/images/avatar/1.jpg" class="avatar" alt="Irina Shayk">
                                </div>
                                <span class="user-name">Irina Shayk</span>
                                <span class="user-show"></span>
                            </li>
                            <!-- BEGIN USER-->
                            <li class="user-tooltip" data-id="6" data-status="offline" data-username="Sara Tancredi" data-position="left" data-filter-item="" data-filter-name="sara tancredi">
                                <div class="user-image">
                                    <img src="../statics/assets/images/avatar/1.jpg" class="avatar" alt="Sara Tancredi">
                                </div>
                                <span class="user-name">Sara Tancredi</span>
                                <span class="user-show"></span>
                            </li>
                            <!-- BEGIN USER-->
                            <li class="user-tooltip" data-id="7" data-status="offline" data-username="XSHURA" data-position="left" data-filter-item="" data-filter-name="XSHURA">
                                <div class="user-image">
                                    <img src="../statics/assets/images/avatar/1.jpg" class="avatar" alt="XSHURA">
                                </div>
                                <span class="user-name">XSHURA</span>
                                <span class="user-show"></span>
                            </li>
                        </ul>
                        <div class="chat-user-search">
                            <div class="input-group">
                                <span class="input-group-addon"><i class="ti-search"></i></span>
                                <input type="text" class="form-control" placeholder="Search" data-search="">
                            </div>
                        </div>
                    </div>
                    <!-- END USERS -->
                </div>
            </div>
            <!-- END SIDEBAR -->
        </div>
        <!-- END chat -->
    </div>
    <!-- END chat Sidebar-->
    <div class="content-wrap">
        <div class="main">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-8 p-0">
                        <div class="page-header">
                            <div class="page-title">
                                <h1>Resource</h1>
                            </div>
                        </div>
                    </div>
                    <!-- /# column -->
                    <div class="col-lg-4 p-0">
                        <div class="page-header">
                            <div class="page-title">
                                <ol class="breadcrumb text-right">
                                    <li><a href="#">Admin</a></li>
                                    <li class="active">Home</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                    <!-- /# column -->
                </div>
                <!-- /# row -->
                    <!-- /# row -->
                    <!-- /# row -->
             <!-- /# column -->
                <div class="wrapper">
                <div class="col">
                    <div class="drag-drawflow" draggable="true" ondragstart="drag(event)" data-node="starttask">
                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-circle-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                      <circle cx="8" cy="8" r="8"/>
                    </svg>          <span>Start Task</span>
                    </div>

                    <div class="drag-drawflow" draggable="true" ondragstart="drag(event)" data-node="midtask">
                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-circle-half" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                      <path fill-rule="evenodd" d="M8 15V1a7 7 0 1 1 0 14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"/>
                    </svg>          <span>Mid Task</span>
                    </div>
                    <div class="drag-drawflow" draggable="true" ondragstart="drag(event)" data-node="endtask">
                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-circle" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                      <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                    </svg>          <span>End Task</span>
                    </div>
                    <div class="drag-drawflow" draggable="true" ondragstart="drag(event)" data-node="multiple">
                      <i class="fas fa-code-branch"></i><span> Multiple inputs/outputs</span>
                    </div>
                    <div class="drag-drawflow" draggable="true" ondragstart="drag(event)" data-node="personalized">
                      <i class="fas fa-fill"></i><span> Personalized</span>
                    </div>
                    <div class="drag-drawflow" draggable="true" ondragstart="drag(event)" data-node="dbclick">
                      <i class="fas fa-mouse"></i><span> DBClick!</span>
                    </div>


                </div>
                <div class="col-right">
                  <div class="menu">
                    <ul>
                      <li onclick="editor.changeModule('Home'); changeModule(event);" class="selected">Home</li>
                      <li onclick="editor.changeModule('Other'); changeModule(event);">Other Module</li>
                    </ul>
                  </div>
                  <div id="drawflow" ondrop="drop(event)" ondragover="allowDrop(event)">
                      <div class="btn-export" id="import">Import</div>
                      <div class="btn-clear" onclick="editor.clearModuleSelected()">Clear</div>
                    <div class="btn-lock">
                      <i id="lock" class="fas fa-lock" onclick="editor.editor_mode='fixed'; changeMode('lock');"></i>
                      <i id="unlock" class="fas fa-lock-open" onclick="editor.editor_mode='edit'; changeMode('unlock');" style="display:none;"></i>
                    </div>
                    <div class="bar-zoom">
                      <i class="fas fa-search-minus" onclick="editor.zoom_out()"></i>
                      <i class="fas fa-search" onclick="editor.zoom_reset()"></i>
                      <i class="fas fa-search-plus" onclick="editor.zoom_in()"></i>
                    </div>
                      <div class="btn-clear" style="color: #000000;, float: right; margin-top: 0px;position: absolute; right: 150px;">DAG流程描述   <input id="dag_name" type="text"><div>

                  </div>
                </div>
              </div>

             </div>
                </div>
        </div>
     <!-- /# container-fluid -->
    </div>

    <script src="../statics/draw.js"></script>

<!-- /# main -->
    </div>
<!-- /# content wrap -->
<script src="../statics/assets/js/lib/jquery.min.js"></script>
<!-- jquery vendor -->
<script src="../statics/assets/js/lib/jquery.nanoscroller.min.js"></script>
<!-- nano scroller -->
<script src="../statics/assets/js/lib/sidebar.js"></script>
<!-- sidebar -->
<script src="../statics/assets/js/lib/bootstrap.min.js"></script>
<!-- bootstrap -->
<script src="../statics/assets/js/lib/mmc-common.js"></script>
<script src="../statics/assets/js/lib/mmc-chat.js"></script>
<!--  Chart js -->
<script src="../statics/assets/js/lib/chart-js/Chart.bundle.js"></script>
<script src="../statics/assets/js/lib/chart-js/chartjs-init.js"></script>
<!-- // Chart js -->
<!--  Datamap -->
<script src="../statics/assets/js/lib/datamap/d3.min.js"></script>
<script src="../statics/assets/js/lib/datamap/topojson.js"></script>
<script src="../statics/assets/js/lib/datamap/datamaps.world.min.js"></script>
<script src="../statics/assets/js/lib/datamap/datamap-init.js"></script>
<script src="../statics/assets/lib/lobipanel/js/lobipanel.js"></script>
<!-- // Datamap -->
<script src="../statics/assets/js/scripts.js"></script>
<!-- scripit init-->
<script>
    $(document).ready(function() {
        $('#lobipanel-custom-control').lobiPanel({
            reload: false,
            close: false,
            editTitle: false
        });
    });
</script>
<!--            var obj = JSON.stringify(editor.export(), null,4);-->

<script>
    $("#import").on("click", function () {
        var node_list = []
        var edge_list = []

        var edgelist = $("svg.connection");
        for(var i=0;i<edgelist.length;i++){
            edge = $(edgelist[i]).attr("class");
            edge_list.push(edge)
        }
        var nodelist=$("div.drawflow-node");
        for(var i=1;i<nodelist.length;i++){
            var id = $(nodelist[i]).attr("id")
            var data = {
                        "id": id,
                        "task": $("div#"+id+"").children("div.drawflow_content_node").children("div").children("div").children("[df='task']").val(),
                        "occupy": $("div#"+id+"").children("div.drawflow_content_node").children("div").children("div").children("[df='occupy']").val(),
                        "type": $("div#"+id+"").children("div.drawflow_content_node").children("div").children("div").children("[df='type']").find('option:selected').text()
                        }
            node_list.push(data)
        }
        var json_dist = {"dag_name": $("input#dag_name").val(),"node_list": node_list, "edge_list": edge_list}
        var post_json = JSON.stringify(json_dist)
        $.ajax({
            url: "/dag/add/",
            type: "post",
            data: post_json,
            contentType:'application/json',  //告诉后端你这次的数据是json格式
　　　　　　   dataType:'json',
            success: function (data) {
                if(data.code==0){
                     alert("添加成功");
                }else{
                     alert("添加失败");
                }
            }
        })
    });
</script>
</body>

</html>